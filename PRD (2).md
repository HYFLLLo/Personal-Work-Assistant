# 个人工作助手项目文档（PRD/TRD）  
## 一、产品需求文档（PRD）
### 1.1 产品愿景
打造轻量级个人工作流AI助手，通过**自动化信息检索→结构化处理→专业汇报生成**闭环，解决职场中重复性资料整理痛点，同时作为AI Agent架构的实践载体。

### 1.2 核心用户画像
| 角色 | 需求场景 | 本项目价值 |
|------|----------|------------|
| 职场执行者 | 每日需整合多源信息生成简报/周报 | 减少80%资料搜集与格式整理时间 |
| AI学习者 | 希望理解工业级Agent工作流设计 | 可视化流程+完整代码实现教学价值 |

### 1.3 功能需求（MVP范围）
| 模块 | 功能点 | 验收标准 |
|------|--------|----------|
| **任务输入** | 文本框提交任务（例：“生成Q3市场趋势分析”） | 支持中文输入，防XSS过滤 |
| **智能处理** | 1. 自动拆解任务步骤2. 调用搜索工具获取资料3. 验证信息可靠性4. 生成结构化报告 | 搜索关键词≥2个；验证失败时触发重规划；报告含摘要/数据/结论 |
| **流式交互** | 实时显示：- Planner思考过程- 搜索关键词/结果摘要- Verifier校验反馈- 最终报告 | 延迟<2s/事件；前端区分消息类型（颜色/图标） |
| **结果导出** | 一键复制报告内容 | 保留Markdown格式 |
| **多轮对话** | 1. 追问报告细节<br>2. 选中段落修改<br>3. 补充扩展内容 | 支持最多10轮上下文；LocalStorage持久化；段落级精准修改 |

### 1.4 非功能需求
- **性能**：单任务端到端耗时≤90秒（含搜索）
- **体验**：SSE断连自动重试（前端实现）
- **安全**：API密钥后端环境变量管理；输入内容长度限制（≤500字符）
- **可观测**：关键节点日志（Planner输出/搜索Query/验证结果）

### 1.5 用户旅程示例
```mermaid
journey
    title “生成行业周报”任务流
    section 用户侧
      输入任务: 5: 用户
      查看实时进度: 4: 用户
      复制报告: 5: 用户
    section 系统侧
      Planner拆解步骤: 5: 系统
      Executor搜索+整理: 4: 系统
      Verifier校验: 3: 系统
      流式推送结果: 5: 系统

### 1.6 多轮对话用户旅程
```mermaid
journey
    title "多轮对话协作"任务流
    section 第一轮：生成报告
      输入任务: 5: 用户
      查看完整报告: 5: 用户
    section 第二轮：追问细节
      选中段落追问: 5: 用户
      获得详细解释: 5: 用户
    section 第三轮：修改内容
      选中段落修改: 4: 用户
      查看修改结果: 5: 用户
    section 第四轮：补充扩展
      要求补充内容: 4: 用户
      获得扩展段落: 5: 用户
```

### 1.7 多轮对话交互规范

**追问模式**
- 触发方式：用户选中报告段落 → 点击"追问"按钮 → 输入问题
- 系统响应：基于选中段落和上下文生成回答，不修改原报告
- 展示方式：在对话框中显示问答记录

**修改模式**
- 触发方式：用户选中报告段落 → 点击"修改"按钮 → 输入修改要求
- 系统响应：仅修改选中段落，保留其他内容不变
- 展示方式：Diff高亮显示修改内容，支持版本对比

**补充模式**
- 触发方式：用户定位插入位置 → 点击"补充"按钮 → 输入补充要求
- 系统响应：在指定位置生成新内容，风格与原文一致
- 展示方式：新内容高亮标识，支持撤销